{% extends "base.html" %}

{% block title %}Church Video Library{% endblock %}

{% block content %}
    <div style="max-width: 1200px; margin: 0 auto;">
        <h2>Video Library</h2>

        {% if videos %}
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                {% for video in videos %}
                    {% with embed_id=video.get_youtube_embed_id %}
                        
                        <div class="card">
                            <h4>{{ video.title }}</h4>

                            {% if embed_id %}
                                <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
                                    <iframe src="https://www.youtube.com/embed/{{ embed_id }}" 
                                            frameborder="0" 
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                            allowfullscreen 
                                            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;">
                                    </iframe>
                                </div>
                            {% else %}
                                <p style="color: red; padding: 10px; background-color: #ffe0e0; border: 1px dashed red;">
                                    ⚠️ Video embed failed. Check the URL format.
                                </p>
                            {% endif %}
                            
                            <p style="font-size: 0.9em; margin-top: 10px;">{{ video.description|truncatechars:100 }}</p>
                        </div>

                    {% endwith %}
                {% empty %}
                    <p>No videos have been posted yet.</p>
                {% endfor %}
            </div>
        {% else %}
            <p>No videos have been posted yet.</p>
        {% endif %}
    </div>
{% endblock content %}